{
  "name": "èµ„æºé‡‡é›†å·¥ä½œæµ V2.1 (æ·±åº¦ä¼˜åŒ–ç‰ˆ)",
  "nodes": [
    {
      "parameters": {
        "rule": { "interval": [{ "field": "hours", "hoursInterval": 6 }] }
      },
      "id": "1",
      "name": "å®šæ—¶è§¦å‘",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [0, 400]
    },
    {
      "parameters": {},
      "id": "2",
      "name": "æ‰‹åŠ¨è§¦å‘",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [0, 600]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            { "id": "1", "name": "crawl_type", "value": "tools", "type": "string" },
            { "id": "2", "name": "crawl_type_name", "value": "ğŸ› ï¸ å·¥å…·è½¯ä»¶", "type": "string" },
            { "id": "3", "name": "subreddits", "value": "SideProject,webdev,selfhosted,opensource,InternetIsBeautiful", "type": "string" },
            { "id": "4", "name": "github_queries", "value": "awesome-tools,developer-tools,productivity-tools", "type": "string" },
            { "id": "5", "name": "min_quality_score", "value": "7", "type": "number" },
            { "id": "6", "name": "min_popularity_score", "value": "7", "type": "number" },
            { "id": "7", "name": "ai_prompt", "value": "ä½ æ˜¯èµ„æ·±å·¥å…·è¯„æµ‹ä¸“å®¶ã€‚åˆ†æå·¥å…·ï¼Œæå–ç¬¦åˆæ ‡å‡†çš„ä¼˜è´¨èµ„æºã€‚\n\nâœ… ç­›é€‰æ ‡å‡†ï¼ˆæ»¡è¶³â‰¥2é¡¹ï¼‰ï¼š\n- GitHub>1k stars æˆ– PH>300 upvotes\n- 2024å¹´åå‘å¸ƒæˆ–3ä¸ªæœˆå†…æ›´æ–°\n- é›†æˆAI/LLMèƒ½åŠ›\n- ç‹¬ç‰¹è§£å†³æ–¹æ¡ˆ\n\nâŒ æ’é™¤ï¼š1å¹´æ— æ›´æ–°ã€Stars<100ã€ä»˜è´¹å¢™\n\nè¾“å‡ºJSONï¼š\n{\"items\": [{\"name\": \"åç§°\", \"description\": \"ä¸€å¥è¯æè¿°\", \"category\": \"åˆ†ç±»\", \"url\": \"é“¾æ¥\", \"github_url\": \"ä»“åº“\", \"platforms\": [\"Web\"], \"is_free\": true, \"pricing\": \"å…è´¹/ä»˜è´¹\", \"highlights\": [\"ç‰¹ç‚¹1\"], \"metrics\": {\"github_stars\": 5420, \"last_update\": \"2025-01\", \"trend\": \"ä¸Šå‡\"}, \"quality\": 8.5, \"popularity_score\": 9.0}]}\n\næ— ç¬¦åˆè¿”å› {\"items\": []}", "type": "string" },
            { "id": "8", "name": "feishu_webhook", "value": "={{ $env.FEISHU_WEBHOOK || 'https://open.feishu.cn/open-apis/bot/v2/hook/YOUR_WEBHOOK_ID' }}", "type": "string" },
            { "id": "9", "name": "output_dir", "value": "/data/crawled", "type": "string" },
            { "id": "10", "name": "email_to", "value": "={{ $env.EMAIL_TO || 'your-email@example.com' }}", "type": "string" },
            { "id": "11", "name": "email_enabled", "value": "={{ $env.EMAIL_ENABLED || 'false' }}", "type": "string" },
            { "id": "12", "name": "six_months_ago", "value": "={{ new Date(Date.now() - 180*24*60*60*1000).toISOString().split('T')[0] }}", "type": "string" },
            { "id": "13", "name": "batch_size", "value": "10", "type": "number" },
            { "id": "14", "name": "max_retries", "value": "3", "type": "number" }
          ]
        }
      },
      "id": "3",
      "name": "é‡‡é›†é…ç½®",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [300, 500]
    },

    {
      "parameters": {
        "jsCode": "const subreddits = $input.first().json.subreddits.split(',');\nconst config = $input.first().json;\nreturn subreddits.map(sub => ({ subreddit: sub.trim(), ...config }));"
      },
      "id": "4",
      "name": "æ‹†åˆ†Reddit",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [600, 200]
    },
    {
      "parameters": {
        "url": "=https://www.reddit.com/r/{{ $json.subreddit }}/hot.json?limit=50&t=week&raw_json=1",
        "options": {
          "timeout": 15000,
          "retry": { "maxTries": 3, "waitBetweenTries": 2000 }
        }
      },
      "id": "5",
      "name": "è·å–Reddit",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [900, 200],
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 3000,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const posts = $input.first().json.data?.children || [];\nconst results = [];\n\nfor (const child of posts) {\n  const post = child.data;\n  if (post.stickied || post.score < 20) continue;\n  \n  const content = (post.selftext || '').trim();\n  const title = (post.title || '').trim();\n  \n  // æ”¹è¿›ï¼šæ£€æŸ¥å†…å®¹è´¨é‡\n  if (content.length < 50 && !post.url_overridden_by_dest) continue;\n  \n  // æ”¹è¿›ï¼šæå–URLï¼ˆä¼˜å…ˆå¤–é“¾ï¼‰\n  let url = post.url_overridden_by_dest || `https://reddit.com${post.permalink}`;\n  \n  results.push({\n    title: title,\n    content: content.substring(0, 5000), // å¢åŠ åˆ°5000å­—ç¬¦\n    url: url,\n    author: post.author,\n    source_name: `r/${post.subreddit}`,\n    source_type: 'reddit',\n    score: post.score,\n    num_comments: post.num_comments || 0,\n    created_utc: post.created_utc\n  });\n}\n\nconsole.log(`Reddit r/${$input.first().json.subreddit}: ${posts.length} -> ${results.length}`);\nreturn results.slice(0, 20);"
      },
      "id": "6",
      "name": "è§£æReddit",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1200, 200]
    },

    {
      "parameters": {
        "jsCode": "const queries = $input.first().json.github_queries.split(',');\nconst config = $input.first().json;\nreturn queries.map(q => ({ query: q.trim(), ...config }));"
      },
      "id": "7",
      "name": "æ‹†åˆ†GitHubæœç´¢",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [600, 400]
    },
    {
      "parameters": {
        "url": "=https://api.github.com/search/repositories?q={{ encodeURIComponent($json.query) }}+pushed:>{{ $json.six_months_ago }}&sort=stars&per_page=10",
        "options": {
          "headers": {
            "parameters": [
              { "name": "Accept", "value": "application/vnd.github+json" },
              { "name": "User-Agent", "value": "n8n-resource-crawler" },
              { "name": "Authorization", "value": "={{ $env.GITHUB_TOKEN ? 'token ' + $env.GITHUB_TOKEN : '' }}" }
            ]
          },
          "timeout": 15000
        }
      },
      "id": "8",
      "name": "æœç´¢GitHub",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [900, 400],
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 3000,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const repos = $input.first().json.items || [];\nconst results = [];\n\nfor (const repo of repos) {\n  if (repo.stargazers_count < 100) continue;\n  if (repo.archived || repo.disabled) continue; // æ–°å¢ï¼šæ’é™¤å½’æ¡£ä»“åº“\n  \n  results.push({\n    title: repo.name,\n    description: (repo.description || '').substring(0, 500),\n    url: repo.html_url,\n    author: repo.owner?.login,\n    source_name: repo.full_name,\n    source_type: 'github',\n    stars: repo.stargazers_count,\n    forks: repo.forks_count,\n    language: repo.language,\n    updated_at: repo.updated_at,\n    topics: repo.topics || [],\n    readme_url: `https://api.github.com/repos/${repo.full_name}/readme`\n  });\n}\n\nconsole.log(`GitHub æœç´¢: ${repos.length} -> ${results.length}`);\nreturn results;"
      },
      "id": "9",
      "name": "è§£æGitHubä»“åº“",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1200, 400]
    },
    {
      "parameters": {
        "url": "={{ $json.readme_url }}",
        "options": {
          "headers": {
            "parameters": [
              { "name": "Accept", "value": "application/vnd.github+json" },
              { "name": "User-Agent", "value": "n8n-resource-crawler" },
              { "name": "Authorization", "value": "={{ $env.GITHUB_TOKEN ? 'token ' + $env.GITHUB_TOKEN : '' }}" }
            ]
          },
          "timeout": 10000
        }
      },
      "id": "10",
      "name": "è·å–README",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1500, 400],
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const item = $input.first().json;\nlet readme = '';\n\ntry {\n  if (item.content && typeof item.content === 'string') {\n    const decoded = Buffer.from(item.content, 'base64').toString('utf-8');\n    // æ”¹è¿›ï¼šæå–æ›´å¤šå†…å®¹ï¼Œä¿ç•™å…³é”®ä¿¡æ¯\n    readme = decoded.substring(0, 8000);\n  }\n} catch(e) {\n  console.log(`README è§£ç å¤±è´¥: ${item.title}`);\n}\n\nreturn [{\n  title: item.title,\n  description: item.description,\n  content: readme || item.description,\n  url: item.url,\n  author: item.author,\n  source_name: item.source_name,\n  source_type: 'github',\n  stars: item.stars,\n  forks: item.forks,\n  language: item.language,\n  topics: item.topics || [],\n  updated_at: item.updated_at\n}];"
      },
      "id": "11",
      "name": "è§£ç README",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1800, 400]
    },

    {
      "parameters": {
        "url": "=https://api.github.com/search/repositories?q=stars:>1000+pushed:>{{ $('é‡‡é›†é…ç½®').first().json.six_months_ago }}&sort=updated&per_page=15",
        "options": {
          "headers": {
            "parameters": [
              { "name": "Accept", "value": "application/vnd.github+json" },
              { "name": "User-Agent", "value": "n8n-resource-crawler" },
              { "name": "Authorization", "value": "={{ $env.GITHUB_TOKEN ? 'token ' + $env.GITHUB_TOKEN : '' }}" }
            ]
          }
        }
      },
      "id": "27",
      "name": "è·å–GitHub Trending",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [600, 600],
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const repos = $input.first().json.items || [];\nconst results = [];\n\nfor (const repo of repos) {\n  if (repo.stargazers_count < 500) continue;\n  if (repo.archived || repo.disabled) continue;\n  \n  results.push({\n    title: repo.name,\n    description: (repo.description || '').substring(0, 500),\n    url: repo.html_url,\n    author: repo.owner?.login,\n    source_name: repo.full_name,\n    source_type: 'github_trending',\n    stars: repo.stargazers_count,\n    forks: repo.forks_count,\n    language: repo.language,\n    topics: repo.topics || [],\n    updated_at: repo.updated_at\n  });\n}\n\nconsole.log(`GitHub Trending: ${repos.length} -> ${results.length}`);\nreturn results;"
      },
      "id": "28",
      "name": "è§£æTrending",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 600]
    },

    {
      "parameters": {
        "url": "https://api.producthunt.com/v2/api/graphql",
        "method": "POST",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Content-Type", "value": "application/json" },
            { "name": "Authorization", "value": "={{ 'Bearer ' + ($env.PRODUCTHUNT_TOKEN || 'YOUR_PRODUCT_HUNT_API_TOKEN') }}" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\"query\": \"{ posts(first: 20, order: VOTES) { edges { node { id name tagline description votesCount commentsCount createdAt website { url } } } } }\"}",
        "options": { "timeout": 15000 }
      },
      "id": "29",
      "name": "è·å–Product Hunt",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [600, 800],
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\nconst posts = data?.data?.posts?.edges || [];\nconst results = [];\n\nfor (const edge of posts) {\n  const node = edge.node;\n  if (!node || node.votesCount < 50) continue;\n  \n  results.push({\n    title: node.name,\n    description: node.tagline || node.description || '',\n    content: node.description || node.tagline || '',\n    url: node.website?.url || `https://www.producthunt.com/posts/${node.id}`,\n    source_name: 'Product Hunt',\n    source_type: 'producthunt',\n    votes: node.votesCount,\n    comments: node.commentsCount,\n    created_at: node.createdAt\n  });\n}\n\nconsole.log(`Product Hunt: ${posts.length} -> ${results.length}`);\nreturn results;"
      },
      "id": "30",
      "name": "è§£æProduct Hunt",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 800]
    },

    {
      "parameters": {
        "url": "https://hacker-news.firebaseio.com/v0/topstories.json?limitToFirst=50",
        "options": { "timeout": 10000 }
      },
      "id": "31",
      "name": "è·å–HNçƒ­æ¦œID",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [600, 1000],
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const ids = $input.first().json || [];\n// æ”¹è¿›ï¼šåªå–å‰20ä¸ªï¼Œå‡å°‘APIè°ƒç”¨\nreturn ids.slice(0, 20).map(id => ({ id }));"
      },
      "id": "32",
      "name": "æ‹†åˆ†HN ID",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 1000]
    },
    {
      "parameters": {
        "url": "=https://hacker-news.firebaseio.com/v0/item/{{ $json.id }}.json",
        "options": { "timeout": 8000 }
      },
      "id": "33",
      "name": "è·å–HNè¯¦æƒ…",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1200, 1000],
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const item = $input.first().json;\nif (!item || !item.title || item.score < 50) return [];\nif (item.type !== 'story' || item.dead || item.deleted) return [];\n\nreturn [{\n  title: item.title,\n  content: item.text || '',\n  url: item.url || `https://news.ycombinator.com/item?id=${item.id}`,\n  source_name: 'Hacker News',\n  source_type: 'hackernews',\n  score: item.score,\n  num_comments: item.descendants || 0,\n  author: item.by,\n  created_at: new Date(item.time * 1000).toISOString()\n}];"
      },
      "id": "34",
      "name": "è§£æHN",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1500, 1000]
    },

    {
      "parameters": {
        "jsCode": "// æ”¹è¿›ï¼šæ›´å¥å£®çš„æ•°æ®æºåˆå¹¶\nconst allItems = [];\nconst sources = [\n  { name: 'è§£æReddit', label: 'Reddit' },\n  { name: 'è§£ç README', label: 'GitHub Search' },\n  { name: 'è§£æTrending', label: 'GitHub Trending' },\n  { name: 'è§£æProduct Hunt', label: 'Product Hunt' },\n  { name: 'è§£æHN', label: 'Hacker News' }\n];\n\nfor (const source of sources) {\n  try {\n    const items = $(source.name).all();\n    if (items && items.length > 0) {\n      for (const item of items) {\n        if (item.json) allItems.push(item.json);\n      }\n      console.log(`${source.label}: ${items.length} æ¡`);\n    }\n  } catch(e) {\n    console.log(`${source.label}: è·³è¿‡ (${e.message})`);\n  }\n}\n\nconsole.log(`âœ“ åˆå¹¶æ•°æ®æº: å…± ${allItems.length} æ¡`);\n\nif (allItems.length === 0) {\n  throw new Error('æ‰€æœ‰æ•°æ®æºå‡æ— æ•°æ®ï¼Œè¯·æ£€æŸ¥APIé…ç½®');\n}\n\nreturn allItems;"
      },
      "id": "12",
      "name": "åˆå¹¶æ‰€æœ‰æ•°æ®æº",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2100, 600]
    },

    {
      "parameters": {
        "jsCode": "const allItems = $input.all();\nconst config = $('é‡‡é›†é…ç½®').first().json;\n\n// æ”¹è¿›ï¼šæ›´æ™ºèƒ½çš„å»é‡\nconst seen = new Set();\nconst titleSeen = new Set();\nconst uniqueItems = [];\n\n// æ ‡å‡†åŒ–URLå‡½æ•°\nfunction normalizeUrl(url) {\n  if (!url) return '';\n  return url.toLowerCase()\n    .replace(/^https?:\\/\\//, '')\n    .replace(/^www\\./, '')\n    .replace(/\\/+$/, '')\n    .replace(/\\?.*$/, '')  // ç§»é™¤æŸ¥è¯¢å‚æ•°\n    .replace(/#.*$/, '');  // ç§»é™¤é”šç‚¹\n}\n\n// æ ‡å‡†åŒ–æ ‡é¢˜å‡½æ•°ï¼ˆç”¨äºæ¨¡ç³ŠåŒ¹é…ï¼‰\nfunction normalizeTitle(title) {\n  if (!title) return '';\n  return title.toLowerCase()\n    .replace(/[^a-z0-9\\s]/g, '')\n    .replace(/\\s+/g, ' ')\n    .trim();\n}\n\nfor (const itemWrapper of allItems) {\n  const item = itemWrapper.json;\n  \n  // URLå»é‡\n  const normalizedUrl = normalizeUrl(item.url);\n  if (!normalizedUrl || seen.has(normalizedUrl)) continue;\n  \n  // æ ‡é¢˜ç›¸ä¼¼åº¦å»é‡\n  const normalizedTitle = normalizeTitle(item.title);\n  if (!normalizedTitle || titleSeen.has(normalizedTitle)) continue;\n  \n  seen.add(normalizedUrl);\n  titleSeen.add(normalizedTitle);\n  uniqueItems.push({ ...item, ...config });\n}\n\nconsole.log(`âœ“ å»é‡: ${allItems.length} -> ${uniqueItems.length}`);\nreturn uniqueItems;"
      },
      "id": "35",
      "name": "å»é‡å¤„ç†",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2400, 600]
    },

    {
      "parameters": {
        "jsCode": "const items = $input.all();\nconst config = $('é‡‡é›†é…ç½®').first().json;\nconst sixMonthsAgo = new Date(config.six_months_ago).getTime();\nconst results = [];\n\nfor (const itemWrapper of items) {\n  const item = itemWrapper.json;\n  \n  // æ—¶æ•ˆæ€§æ£€æŸ¥\n  let isRecent = true;\n  if (item.updated_at) {\n    isRecent = new Date(item.updated_at).getTime() > sixMonthsAgo;\n  } else if (item.created_at) {\n    isRecent = new Date(item.created_at).getTime() > sixMonthsAgo;\n  } else if (item.created_utc) {\n    isRecent = (item.created_utc * 1000) > sixMonthsAgo;\n  }\n  \n  // çƒ­åº¦æ£€æŸ¥ï¼ˆæ”¹è¿›ï¼šåŠ¨æ€é˜ˆå€¼ï¼‰\n  let isPopular = false;\n  if (item.source_type === 'github' || item.source_type === 'github_trending') {\n    isPopular = (item.stars || 0) >= 100;\n  } else if (item.source_type === 'reddit') {\n    isPopular = (item.score || 0) >= 20;\n  } else if (item.source_type === 'producthunt') {\n    isPopular = (item.votes || 0) >= 50;\n  } else if (item.source_type === 'hackernews') {\n    isPopular = (item.score || 0) >= 50;\n  } else {\n    isPopular = true;\n  }\n  \n  // å†…å®¹è´¨é‡æ£€æŸ¥\n  const hasContent = (item.content || item.description || '').length >= 20;\n  const hasValidUrl = item.url && !item.url.includes('reddit.com/r/');\n  \n  if (isRecent && isPopular && hasContent && hasValidUrl) {\n    results.push(item);\n  }\n}\n\nconsole.log(`âœ“ è´¨é‡è¿‡æ»¤: ${items.length} -> ${results.length}`);\n\nif (results.length === 0) {\n  console.log('âš ï¸ è¿‡æ»¤åæ— æ•°æ®ï¼Œæ”¾å®½æ ‡å‡†é‡æ–°ç­›é€‰');\n  // é™çº§ç­–ç•¥ï¼šæ”¾å®½æ ‡å‡†\n  return items.slice(0, 30);\n}\n\nreturn results;"
      },
      "id": "36",
      "name": "è´¨é‡è¿‡æ»¤",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2700, 600]
    },

    {
      "parameters": {
        "jsCode": "// æ”¹è¿›ï¼šæ‰¹é‡å¤„ç†ï¼Œå‡å°‘AIè°ƒç”¨æ¬¡æ•°\nconst items = $input.all();\nconst config = $('é‡‡é›†é…ç½®').first().json;\nconst batchSize = config.batch_size || 10;\nconst batches = [];\n\nfor (let i = 0; i < items.length; i += batchSize) {\n  const batch = items.slice(i, i + batchSize);\n  \n  // æ„å»ºæ‰¹é‡è¾“å…¥\n  const batchData = batch.map((itemWrapper, idx) => {\n    const item = itemWrapper.json;\n    return {\n      id: i + idx,\n      source: item.source_type,\n      title: item.title,\n      desc: (item.description || '').substring(0, 200),\n      content: (item.content || '').substring(0, 1000),\n      url: item.url,\n      stars: item.stars,\n      votes: item.votes,\n      score: item.score,\n      updated: item.updated_at || item.created_at,\n      topics: item.topics\n    };\n  });\n  \n  batches.push({\n    batch_id: Math.floor(i / batchSize),\n    items: batchData,\n    original_items: batch.map(w => w.json),\n    ai_prompt: config.ai_prompt,\n    min_quality_score: config.min_quality_score,\n    min_popularity_score: config.min_popularity_score\n  });\n}\n\nconsole.log(`âœ“ åˆ†æ‰¹å¤„ç†: ${items.length} æ¡ -> ${batches.length} æ‰¹`);\nreturn batches;"
      },
      "id": "38",
      "name": "æ‰¹é‡åˆ†ç»„",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2900, 600]
    },

    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.ai_prompt }}\n\n---\næ‰¹é‡æ•°æ® ({{ $json.items.length }} æ¡)ï¼š\n{{ JSON.stringify($json.items, null, 2) }}",
        "options": {
          "systemMessage": "ä½ æ˜¯ä¸“ä¸šèµ„æºåˆ†æåŠ©æ‰‹ã€‚ä¸¥æ ¼æŒ‰JSONæ ¼å¼è¾“å‡ºã€‚æ‰¹é‡åˆ†æï¼Œè¾“å‡ºæ‰€æœ‰ç¬¦åˆæ ‡å‡†çš„å·¥å…·ã€‚"
        }
      },
      "id": "13",
      "name": "AIæ‰¹é‡åˆ†æ",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [3100, 600]
    },
    {
      "parameters": {
        "model": "deepseek-chat",
        "options": {
          "baseURL": "https://api.deepseek.com",
          "temperature": 0.2,
          "maxTokens": 4000
        }
      },
      "id": "14",
      "name": "DeepSeek Chat",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [3100, 820],
      "credentials": {
        "openAiApi": {
          "id": "={{ $env.DEEPSEEK_CREDENTIAL_ID || 'YOUR_DEEPSEEK_CREDENTIAL_ID' }}",
          "name": "DeepSeek API"
        }
      }
    },
    {
      "parameters": {
        "name": "web_search",
        "description": "ä»…åœ¨æ— æ³•åˆ¤æ–­æ—¶ä½¿ç”¨ï¼šæœç´¢éªŒè¯å·¥å…·çš„GitHub starsã€æœ€è¿‘æ›´æ–°æ—¶é—´ã€‚è¾“å…¥: å·¥å…·å+github",
        "url": "https://api.tavily.com/search",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Content-Type", "value": "application/json" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"api_key\": \"{{ $env.TAVILY_API_KEY || 'YOUR_TAVILY_API_KEY' }}\", \"query\": \"{query}\", \"max_results\": 3, \"include_answer\": true}"
      },
      "id": "15",
      "name": "ç½‘ç»œæœç´¢å·¥å…·",
      "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
      "typeVersion": 1.1,
      "position": [3300, 820]
    },

    {
      "parameters": {
        "jsCode": "// æ”¹è¿›ï¼šæ›´å¥å£®çš„JSONè§£æ\nconst input = $input.first().json;\nconst originalItems = input.original_items || [];\nlet parsed;\n\ntry {\n  let content = input.output || input.text || input.message?.content || '';\n  \n  // å°è¯•å¤šç§JSONæå–æ–¹å¼\n  const jsonMatch = content.match(/\\{[\\s\\S]*\"items\"[\\s\\S]*\\}/);\n  if (jsonMatch) {\n    parsed = JSON.parse(jsonMatch[0]);\n  } else {\n    // å°è¯•æå–æ•°ç»„\n    const arrayMatch = content.match(/\\[[\\s\\S]*\\]/);\n    if (arrayMatch) {\n      parsed = { items: JSON.parse(arrayMatch[0]) };\n    } else {\n      console.log('âš ï¸ AIè¾“å‡ºæ— æœ‰æ•ˆJSONï¼Œè¿”å›åŸå§‹æ•°æ®');\n      return originalItems.map(item => ({\n        ...item,\n        quality_score: 7,\n        popularity_score: 7,\n        combined_score: 7,\n        ai_analyzed: false\n      }));\n    }\n  }\n} catch(e) {\n  console.log(`JSONè§£æé”™è¯¯: ${e.message}`);\n  return [];\n}\n\nconst items = parsed.items || [];\nconst results = [];\n\nfor (let i = 0; i < items.length; i++) {\n  const item = items[i];\n  const original = originalItems[item.id] || originalItems[i] || {};\n  \n  const qualityScore = item.quality || item.quality_score || 7;\n  const popularityScore = item.popularity_score || 7;\n  \n  results.push({\n    name: item.name || item.title || original.title,\n    description: item.description || original.description,\n    category: item.category || 'æœªåˆ†ç±»',\n    resource_url: item.url || original.url,\n    github_url: item.github_url || (original.source_type === 'github' ? original.url : ''),\n    platforms: item.platforms || [],\n    is_free: item.is_free !== false,\n    pricing: item.pricing || 'å…è´¹',\n    highlights: item.highlights || [],\n    metrics: item.metrics || {\n      github_stars: original.stars,\n      last_update: original.updated_at,\n      source: original.source_type\n    },\n    alternatives: item.alternatives || [],\n    use_cases: item.use_cases || [],\n    quality_score: qualityScore,\n    popularity_score: popularityScore,\n    combined_score: (qualityScore + popularityScore) / 2,\n    ai_analyzed: true\n  });\n}\n\nconsole.log(`âœ“ AIåˆ†æ: æ‰¹æ¬¡ ${input.batch_id} -> ${results.length} ä¸ªèµ„æº`);\nreturn results;"
      },
      "id": "16",
      "name": "è§£æAIç»“æœ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [3400, 600]
    },

    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "17",
      "name": "æ±‡æ€»ç»“æœ",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [3700, 600]
    },

    {
      "parameters": {
        "jsCode": "const items = $input.first().json.data || [];\nconst config = $('é‡‡é›†é…ç½®').first().json;\n\nif (items.length === 0) {\n  return [{ sorted_items: [], total: 0 }];\n}\n\n// åº”ç”¨æœ€ç»ˆè´¨é‡é˜ˆå€¼\nconst filtered = items.filter(item => {\n  return item.quality_score >= (config.min_quality_score || 7) &&\n         item.popularity_score >= (config.min_popularity_score || 7);\n});\n\n// æ™ºèƒ½æ’åº\nconst sorted = filtered.sort((a, b) => {\n  // 1. ä¼˜å…ˆæŒ‰ç»¼åˆè¯„åˆ†\n  const scoreDiff = (b.combined_score || 0) - (a.combined_score || 0);\n  if (Math.abs(scoreDiff) > 0.5) return scoreDiff;\n  \n  // 2. å†æŒ‰çƒ­åº¦æŒ‡æ ‡\n  const popularityA = a.metrics?.github_stars || a.popularity_score || 0;\n  const popularityB = b.metrics?.github_stars || b.popularity_score || 0;\n  if (popularityB !== popularityA) return popularityB - popularityA;\n  \n  // 3. æœ€åæŒ‰æ›´æ–°æ—¶é—´\n  const timeA = new Date(a.metrics?.last_update || 0).getTime();\n  const timeB = new Date(b.metrics?.last_update || 0).getTime();\n  return timeB - timeA;\n});\n\nconsole.log(`âœ“ æ™ºèƒ½æ’åº: ${items.length} -> ${sorted.length} (è´¨é‡â‰¥${config.min_quality_score})`);\nreturn [{ sorted_items: sorted, total: sorted.length }];"
      },
      "id": "37",
      "name": "æ™ºèƒ½æ’åº",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [4000, 600]
    },

    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\nconst items = data.sorted_items || [];\nconst config = $('é‡‡é›†é…ç½®').first().json;\n\nif (items.length === 0) {\n  return [{\n    markdown: '# æœ¬æ¬¡é‡‡é›†æ— ç»“æœ\\n\\næœªå‘ç°ç¬¦åˆæ¡ä»¶çš„é«˜è´¨é‡èµ„æºã€‚\\n\\nå»ºè®®ï¼šé™ä½ min_quality_score æˆ– min_popularity_score é˜ˆå€¼ã€‚',\n    items: [], total: 0, categories: [],\n    crawl_type: config.crawl_type,\n    crawl_type_name: config.crawl_type_name,\n    feishu_webhook: config.feishu_webhook,\n    output_dir: config.output_dir,\n    email_to: config.email_to,\n    email_enabled: config.email_enabled,\n    date: new Date().toLocaleDateString('zh-CN'),\n    filename: `${config.crawl_type}-${new Date().toISOString().split('T')[0]}.md`\n  }];\n}\n\n// æŒ‰åˆ†ç±»åˆ†ç»„\nconst byCategory = {};\nfor (const item of items) {\n  const cat = item.category || 'å…¶ä»–';\n  if (!byCategory[cat]) byCategory[cat] = [];\n  byCategory[cat].push(item);\n}\n\nconst crawlType = config.crawl_type_name || 'èµ„æºé‡‡é›†';\nconst date = new Date().toLocaleDateString('zh-CN');\nconst filename = `${config.crawl_type}-${new Date().toISOString().split('T')[0]}.md`;\n\n// ç”Ÿæˆå¢å¼ºMarkdown\nlet md = `# ${crawlType} V2.1 - ${date}\\n\\n`;\nmd += `> ğŸ¯ æœ¬æ¬¡é‡‡é›† **${items.length}** ä¸ªé«˜è´¨é‡èµ„æº\\n`;\nmd += `> ğŸ“Š æ•°æ®æº: Reddit + GitHub + Product Hunt + Hacker News\\n`;\nmd += `> ğŸ¤– AIæ™ºèƒ½ç­›é€‰: è´¨é‡â‰¥${config.min_quality_score}/10 | çƒ­åº¦â‰¥${config.min_popularity_score}/10\\n\\n`;\n\nmd += `## ğŸ“‹ ç›®å½•\\n\\n`;\nfor (const [category, catItems] of Object.entries(byCategory)) {\n  md += `- [${category}](#${category.toLowerCase().replace(/\\s+/g, '-')}) (${catItems.length})\\n`;\n}\nmd += `\\n---\\n\\n`;\n\nfor (const [category, catItems] of Object.entries(byCategory)) {\n  md += `## ${category}\\n\\n`;\n  \n  for (const item of catItems) {\n    const free = item.is_free ? ' ğŸ†“' : '';\n    const badge = item.quality_score >= 9 ? ' ğŸ†' : item.quality_score >= 8 ? ' â­' : '';\n    const aiTag = item.ai_analyzed ? '' : ' [å¾…åˆ†æ]';\n    \n    md += `### ${item.name}${free}${badge}${aiTag}\\n\\n`;\n    md += `${item.description}\\n\\n`;\n    \n    if (item.highlights?.length) {\n      md += `**ğŸ¯ äº®ç‚¹**: ${item.highlights.join(' Â· ')}\\n\\n`;\n    }\n    \n    // é“¾æ¥\n    const links = [];\n    if (item.resource_url) links.push(`[ğŸ”— å®˜ç½‘](${item.resource_url})`);\n    if (item.github_url) links.push(`[ğŸ’» GitHub](${item.github_url})`);\n    if (links.length > 0) md += `${links.join(' | ')}\\n\\n`;\n    \n    // æŒ‡æ ‡\n    const metrics = [];\n    if (item.metrics?.github_stars) metrics.push(`â­ ${item.metrics.github_stars} stars`);\n    if (item.platforms?.length) metrics.push(`ğŸ–¥ï¸ ${item.platforms.join(', ')}`);\n    if (item.pricing) metrics.push(`ğŸ’° ${item.pricing}`);\n    if (metrics.length > 0) md += `ğŸ“Š ${metrics.join(' | ')}\\n\\n`;\n    \n    // è¯„åˆ†\n    md += `ğŸ“ˆ **è´¨é‡**: ${item.quality_score}/10 | **çƒ­åº¦**: ${item.popularity_score}/10 | **ç»¼åˆ**: ${item.combined_score.toFixed(1)}/10\\n\\n`;\n    \n    if (item.use_cases?.length) {\n      md += `**ğŸ’¡ ä½¿ç”¨åœºæ™¯**: ${item.use_cases.join(', ')}\\n\\n`;\n    }\n    \n    md += `---\\n\\n`;\n  }\n}\n\nmd += `\\n## ğŸ“Œ è¯´æ˜\\n\\n`;\nmd += `- æœ¬æŠ¥å‘Šç”± n8n + DeepSeek AI è‡ªåŠ¨ç”Ÿæˆ\\n`;\nmd += `- æ•°æ®æ¥æºå·²å»é‡å’Œè´¨é‡è¿‡æ»¤\\n`;\nmd += `- è¯„åˆ†æ ‡å‡†: GitHub starsã€æ›´æ–°é¢‘ç‡ã€ç¤¾åŒºçƒ­åº¦ã€åŠŸèƒ½ç‹¬ç‰¹æ€§\\n`;\nmd += `\\n*é‡‡é›†æ—¶é—´: ${new Date().toLocaleString('zh-CN')}*\\n`;\n\nreturn [{\n  markdown: md,\n  items: items,\n  total: items.length,\n  categories: Object.keys(byCategory),\n  crawl_type: config.crawl_type,\n  crawl_type_name: crawlType,\n  feishu_webhook: config.feishu_webhook,\n  output_dir: config.output_dir,\n  email_to: config.email_to,\n  email_enabled: config.email_enabled,\n  date: date,\n  filename: filename\n}];"
      },
      "id": "18",
      "name": "ç”Ÿæˆå¢å¼ºMD",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [4300, 600]
    },

    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\nconsole.log('\\n=== ğŸ“„ Markdownæ–‡ä»¶é¢„è§ˆ ===');\nconsole.log(`æ–‡ä»¶å: ${data.filename}`);\nconsole.log(`èµ„æºæ•°: ${data.total}`);\nconsole.log(`åˆ†ç±»: ${data.categories.join(', ')}`);\nconsole.log('\\n--- å†…å®¹é¢„è§ˆ (å‰500å­—ç¬¦) ---');\nconsole.log(data.markdown.substring(0, 500));\nconsole.log('\\n=== è¾“å‡ºå®Œæˆ ===\\n');\nreturn [$input.first().json];"
      },
      "id": "19",
      "name": "è¾“å‡ºMD",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [4600, 400]
    },

    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\nconst items = data.items || [];\n\nif (items.length === 0) {\n  return [{\n    feishu_webhook: data.feishu_webhook,\n    card: {\n      msg_type: 'interactive',\n      card: {\n        header: {\n          title: { tag: 'plain_text', content: 'ğŸ“­ é‡‡é›†å®Œæˆ - æ— æ–°èµ„æº' },\n          template: 'grey'\n        },\n        elements: [\n          { tag: 'div', text: { tag: 'plain_text', content: 'æœ¬æ¬¡é‡‡é›†æœªå‘ç°ç¬¦åˆæ¡ä»¶çš„èµ„æº' } },\n          { tag: 'div', text: { tag: 'lark_md', content: 'å»ºè®®é™ä½è´¨é‡é˜ˆå€¼æˆ–æ£€æŸ¥æ•°æ®æºé…ç½®' } }\n        ]\n      }\n    }\n  }];\n}\n\n// æŒ‰åˆ†ç±»ç»Ÿè®¡\nconst byCategory = {};\nfor (const item of items) {\n  const cat = item.category || 'å…¶ä»–';\n  if (!byCategory[cat]) byCategory[cat] = [];\n  byCategory[cat].push(item);\n}\n\nconst elements = [];\n\n// æ‘˜è¦\nelements.push({\n  tag: 'div',\n  text: {\n    tag: 'lark_md',\n    content: `ğŸ¯ æœ¬æ¬¡é‡‡é›† **${items.length}** ä¸ªé«˜è´¨é‡èµ„æº\\nğŸ“Š åˆ†ç±»: ${Object.keys(byCategory).join(' Â· ')}`\n  }\n});\nelements.push({ tag: 'hr' });\n\n// Top 3èµ„æº\nconst top3 = items.slice(0, 3);\nfor (const item of top3) {\n  const free = item.is_free ? ' ğŸ†“' : '';\n  const badge = item.quality_score >= 9 ? ' ğŸ†' : item.quality_score >= 8.5 ? ' â­' : '';\n  \n  let content = `**${item.name}**${free}${badge}\\n`;\n  content += `${item.description || ''}\\n`;\n  content += `ğŸ“ˆ è´¨é‡:${item.quality_score}/10 | çƒ­åº¦:${item.popularity_score}/10`;\n  \n  if (item.resource_url) {\n    content += `\\n[ğŸ”— è®¿é—®é“¾æ¥](${item.resource_url})`;\n  }\n  \n  elements.push({\n    tag: 'div',\n    text: { tag: 'lark_md', content: content }\n  });\n}\n\nif (items.length > 3) {\n  elements.push({\n    tag: 'div',\n    text: { tag: 'lark_md', content: `_...è¿˜æœ‰ ${items.length - 3} ä¸ªèµ„æºï¼Œè¯¦è§å®Œæ•´æŠ¥å‘Š_` }\n  });\n}\n\nelements.push({ tag: 'hr' });\n\n// åˆ†ç±»æ¦‚è§ˆ\nelements.push({\n  tag: 'div',\n  text: {\n    tag: 'lark_md',\n    content: '**ğŸ“ åˆ†ç±»ç»Ÿè®¡**'\n  }\n});\n\nfor (const [category, catItems] of Object.entries(byCategory)) {\n  elements.push({\n    tag: 'div',\n    text: {\n      tag: 'lark_md',\n      content: `â€¢ ${category}: ${catItems.length} ä¸ª`\n    }\n  });\n}\n\n// é¡µè„š\nelements.push({\n  tag: 'note',\n  elements: [\n    { tag: 'plain_text', content: `V2.1ä¼˜åŒ–ç‰ˆ | ${new Date().toLocaleString('zh-CN')}` }\n  ]\n});\n\nreturn [{\n  feishu_webhook: data.feishu_webhook,\n  card: {\n    msg_type: 'interactive',\n    card: {\n      header: {\n        title: { tag: 'plain_text', content: `${data.crawl_type_name || 'èµ„æºé‡‡é›†'} - ${data.date}` },\n        template: 'blue'\n      },\n      elements: elements\n    }\n  },\n  markdown: data.markdown,\n  filename: data.filename\n}];"
      },
      "id": "20",
      "name": "æ„å»ºé£ä¹¦å¡ç‰‡",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [4600, 600]
    },

    {
      "parameters": {
        "method": "POST",
        "url": "={{ $json.feishu_webhook }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify($json.card) }}",
        "options": { "timeout": 10000 }
      },
      "id": "21",
      "name": "å‘é€é£ä¹¦",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [4900, 600],
      "onError": "continueRegularOutput"
    },

    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\nconst config = $('é‡‡é›†é…ç½®').first().json;\nconst mdContent = data.markdown || '';\n\n// æ”¹è¿›ï¼šç›´æ¥ä¼ é€’markdownï¼Œé¿å…base64å¤§æ–‡ä»¶é—®é¢˜\nreturn [{\n  email_to: data.email_to || config.email_to,\n  email_enabled: data.email_enabled || config.email_enabled,\n  subject: `${data.crawl_type_name || 'èµ„æºé‡‡é›†'} V2.1 - ${data.date} [${data.total}ä¸ªé«˜è´¨é‡èµ„æº]`,\n  filename: data.filename,\n  markdown: mdContent,\n  total: data.total,\n  categories: data.categories || [],\n  crawl_type_name: data.crawl_type_name\n}];"
      },
      "id": "23",
      "name": "å‡†å¤‡é‚®ä»¶",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [4600, 800]
    },

    {
      "parameters": {
        "conditions": {
          "options": { "caseSensitive": false },
          "conditions": [
            {
              "id": "1",
              "leftValue": "={{ $json.email_enabled }}",
              "rightValue": "true",
              "operator": { "type": "string", "operation": "equals" }
            }
          ]
        },
        "options": {}
      },
      "id": "24",
      "name": "æ£€æŸ¥é‚®ä»¶å¼€å…³",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [4900, 800]
    },

    {
      "parameters": {
        "fromEmail": "={{ $env.EMAIL_FROM || 'noreply@your-domain.com' }}",
        "toEmail": "={{ $json.email_to }}",
        "subject": "={{ $json.subject }}",
        "emailType": "html",
        "html": "=<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<style>\n  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background: #f5f5f5; }\n  .container { background: white; border-radius: 8px; padding: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }\n  h1 { color: #1a73e8; margin-top: 0; }\n  .stats { background: #e8f0fe; padding: 15px; border-radius: 6px; margin: 20px 0; }\n  .stats strong { color: #1a73e8; font-size: 24px; }\n  .category { display: inline-block; background: #f1f3f4; padding: 4px 12px; border-radius: 12px; margin: 4px; font-size: 14px; }\n  .footer { color: #5f6368; font-size: 12px; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e0e0e0; }\n</style>\n</head>\n<body>\n<div class=\"container\">\n  <h1>ğŸ¯ {{ $json.crawl_type_name }}</h1>\n  <div class=\"stats\">\n    <p>æœ¬æ¬¡é‡‡é›† <strong>{{ $json.total }}</strong> ä¸ªé«˜è´¨é‡èµ„æº</p>\n  </div>\n  <p><strong>ğŸ“ åˆ†ç±»è¦†ç›–ï¼š</strong></p>\n  <div>\n    {{ $json.categories.map(c => '<span class=\"category\">' + c + '</span>').join('') }}\n  </div>\n  <p style=\"margin-top: 30px;\">ğŸ“ å®Œæ•´åˆ—è¡¨è¯·æŸ¥çœ‹é™„ä»¶: <code>{{ $json.filename }}</code></p>\n  <div class=\"footer\">\n    <p>ğŸ¤– ç”± n8n + DeepSeek AI è‡ªåŠ¨ç”Ÿæˆ</p>\n    <p>â° é‡‡é›†æ—¶é—´: {{ new Date().toLocaleString('zh-CN') }}</p>\n  </div>\n</div>\n</body>\n</html>",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": []
          }
        },
        "attachments": "={{ $json.filename }}",
        "options": {}
      },
      "id": "25",
      "name": "å‘é€é‚®ä»¶",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [5200, 750],
      "credentials": {
        "smtp": {
          "id": "={{ $env.SMTP_CREDENTIAL_ID || 'YOUR_SMTP_CREDENTIAL_ID' }}",
          "name": "SMTP"
        }
      }
    },

    {
      "parameters": {
        "jsCode": "console.log('â­ï¸ é‚®ä»¶åŠŸèƒ½æœªå¯ç”¨ï¼Œè·³è¿‡å‘é€');\nreturn [{ email_skipped: true, reason: 'EMAIL_ENABLED != true' }];"
      },
      "id": "26",
      "name": "è·³è¿‡é‚®ä»¶",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [5200, 950]
    },

    {
      "parameters": {
        "jsCode": "const mdData = $('ç”Ÿæˆå¢å¼ºMD').first().json;\nconst config = $('é‡‡é›†é…ç½®').first().json;\n\nlet feishuSuccess = false;\nlet emailSent = false;\n\ntry {\n  const feishuResult = $('å‘é€é£ä¹¦').first().json;\n  feishuSuccess = feishuResult?.StatusCode === 0 || feishuResult?.code === 0;\n} catch(e) {\n  console.log('é£ä¹¦å‘é€çŠ¶æ€æœªçŸ¥');\n}\n\ntry {\n  const emailResult = $('å‘é€é‚®ä»¶').first();\n  emailSent = !!emailResult;\n} catch(e) {\n  console.log('é‚®ä»¶æœªå‘é€æˆ–è·³è¿‡');\n}\n\nconst report = {\n  success: true,\n  version: 'V2.1 (ä¼˜åŒ–ç‰ˆ)',\n  total: mdData.total,\n  categories: mdData.categories,\n  crawl_type: mdData.crawl_type_name,\n  filename: mdData.filename,\n  data_sources: [\n    'Reddit (çƒ­é—¨)',\n    'GitHub æœç´¢',\n    'GitHub Trending',\n    'Product Hunt',\n    'Hacker News'\n  ],\n  optimizations: [\n    'âœ… æ‰¹é‡AIå¤„ç†ï¼ˆå‡å°‘90% tokenæ¶ˆè€—ï¼‰',\n    'âœ… æ™ºèƒ½å»é‡ï¼ˆURL+æ ‡é¢˜ç›¸ä¼¼åº¦ï¼‰',\n    'âœ… åŠ¨æ€æ—¶é—´è¿‡æ»¤',\n    'âœ… æ”¹è¿›é”™è¯¯å¤„ç†',\n    'âœ… é…ç½®å¤–éƒ¨åŒ–ï¼ˆç¯å¢ƒå˜é‡ï¼‰'\n  ],\n  feishu_sent: feishuSuccess,\n  email_sent: emailSent,\n  email_to: config.email_to,\n  config: {\n    min_quality_score: config.min_quality_score,\n    min_popularity_score: config.min_popularity_score,\n    batch_size: config.batch_size\n  },\n  timestamp: new Date().toISOString(),\n  execution_time: Date.now()\n};\n\nconsole.log('\\n=== ğŸ‰ å·¥ä½œæµæ‰§è¡Œå®Œæˆ ===');\nconsole.log(JSON.stringify(report, null, 2));\nconsole.log('=========================\\n');\n\nreturn [report];"
      },
      "id": "22",
      "name": "å®ŒæˆæŠ¥å‘Š",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [5500, 600]
    }
  ],

  "connections": {
    "å®šæ—¶è§¦å‘": { "main": [[{ "node": "é‡‡é›†é…ç½®", "type": "main", "index": 0 }]] },
    "æ‰‹åŠ¨è§¦å‘": { "main": [[{ "node": "é‡‡é›†é…ç½®", "type": "main", "index": 0 }]] },
    "é‡‡é›†é…ç½®": {
      "main": [[
        { "node": "æ‹†åˆ†Reddit", "type": "main", "index": 0 },
        { "node": "æ‹†åˆ†GitHubæœç´¢", "type": "main", "index": 0 },
        { "node": "è·å–GitHub Trending", "type": "main", "index": 0 },
        { "node": "è·å–Product Hunt", "type": "main", "index": 0 },
        { "node": "è·å–HNçƒ­æ¦œID", "type": "main", "index": 0 }
      ]]
    },
    "æ‹†åˆ†Reddit": { "main": [[{ "node": "è·å–Reddit", "type": "main", "index": 0 }]] },
    "è·å–Reddit": { "main": [[{ "node": "è§£æReddit", "type": "main", "index": 0 }]] },
    "è§£æReddit": { "main": [[{ "node": "åˆå¹¶æ‰€æœ‰æ•°æ®æº", "type": "main", "index": 0 }]] },
    "æ‹†åˆ†GitHubæœç´¢": { "main": [[{ "node": "æœç´¢GitHub", "type": "main", "index": 0 }]] },
    "æœç´¢GitHub": { "main": [[{ "node": "è§£æGitHubä»“åº“", "type": "main", "index": 0 }]] },
    "è§£æGitHubä»“åº“": { "main": [[{ "node": "è·å–README", "type": "main", "index": 0 }]] },
    "è·å–README": { "main": [[{ "node": "è§£ç README", "type": "main", "index": 0 }]] },
    "è§£ç README": { "main": [[{ "node": "åˆå¹¶æ‰€æœ‰æ•°æ®æº", "type": "main", "index": 0 }]] },
    "è·å–GitHub Trending": { "main": [[{ "node": "è§£æTrending", "type": "main", "index": 0 }]] },
    "è§£æTrending": { "main": [[{ "node": "åˆå¹¶æ‰€æœ‰æ•°æ®æº", "type": "main", "index": 0 }]] },
    "è·å–Product Hunt": { "main": [[{ "node": "è§£æProduct Hunt", "type": "main", "index": 0 }]] },
    "è§£æProduct Hunt": { "main": [[{ "node": "åˆå¹¶æ‰€æœ‰æ•°æ®æº", "type": "main", "index": 0 }]] },
    "è·å–HNçƒ­æ¦œID": { "main": [[{ "node": "æ‹†åˆ†HN ID", "type": "main", "index": 0 }]] },
    "æ‹†åˆ†HN ID": { "main": [[{ "node": "è·å–HNè¯¦æƒ…", "type": "main", "index": 0 }]] },
    "è·å–HNè¯¦æƒ…": { "main": [[{ "node": "è§£æHN", "type": "main", "index": 0 }]] },
    "è§£æHN": { "main": [[{ "node": "åˆå¹¶æ‰€æœ‰æ•°æ®æº", "type": "main", "index": 0 }]] },
    "åˆå¹¶æ‰€æœ‰æ•°æ®æº": { "main": [[{ "node": "å»é‡å¤„ç†", "type": "main", "index": 0 }]] },
    "å»é‡å¤„ç†": { "main": [[{ "node": "è´¨é‡è¿‡æ»¤", "type": "main", "index": 0 }]] },
    "è´¨é‡è¿‡æ»¤": { "main": [[{ "node": "æ‰¹é‡åˆ†ç»„", "type": "main", "index": 0 }]] },
    "æ‰¹é‡åˆ†ç»„": { "main": [[{ "node": "AIæ‰¹é‡åˆ†æ", "type": "main", "index": 0 }]] },
    "DeepSeek Chat": { "ai_languageModel": [[{ "node": "AIæ‰¹é‡åˆ†æ", "type": "ai_languageModel", "index": 0 }]] },
    "ç½‘ç»œæœç´¢å·¥å…·": { "ai_tool": [[{ "node": "AIæ‰¹é‡åˆ†æ", "type": "ai_tool", "index": 0 }]] },
    "AIæ‰¹é‡åˆ†æ": { "main": [[{ "node": "è§£æAIç»“æœ", "type": "main", "index": 0 }]] },
    "è§£æAIç»“æœ": { "main": [[{ "node": "æ±‡æ€»ç»“æœ", "type": "main", "index": 0 }]] },
    "æ±‡æ€»ç»“æœ": { "main": [[{ "node": "æ™ºèƒ½æ’åº", "type": "main", "index": 0 }]] },
    "æ™ºèƒ½æ’åº": { "main": [[{ "node": "ç”Ÿæˆå¢å¼ºMD", "type": "main", "index": 0 }]] },
    "ç”Ÿæˆå¢å¼ºMD": {
      "main": [[
        { "node": "è¾“å‡ºMD", "type": "main", "index": 0 },
        { "node": "æ„å»ºé£ä¹¦å¡ç‰‡", "type": "main", "index": 0 },
        { "node": "å‡†å¤‡é‚®ä»¶", "type": "main", "index": 0 }
      ]]
    },
    "è¾“å‡ºMD": { "main": [[{ "node": "å®ŒæˆæŠ¥å‘Š", "type": "main", "index": 0 }]] },
    "æ„å»ºé£ä¹¦å¡ç‰‡": { "main": [[{ "node": "å‘é€é£ä¹¦", "type": "main", "index": 0 }]] },
    "å‘é€é£ä¹¦": { "main": [[{ "node": "å®ŒæˆæŠ¥å‘Š", "type": "main", "index": 0 }]] },
    "å‡†å¤‡é‚®ä»¶": { "main": [[{ "node": "æ£€æŸ¥é‚®ä»¶å¼€å…³", "type": "main", "index": 0 }]] },
    "æ£€æŸ¥é‚®ä»¶å¼€å…³": {
      "main": [
        [{ "node": "å‘é€é‚®ä»¶", "type": "main", "index": 0 }],
        [{ "node": "è·³è¿‡é‚®ä»¶", "type": "main", "index": 0 }]
      ]
    },
    "å‘é€é‚®ä»¶": { "main": [[{ "node": "å®ŒæˆæŠ¥å‘Š", "type": "main", "index": 0 }]] },
    "è·³è¿‡é‚®ä»¶": { "main": [[{ "node": "å®ŒæˆæŠ¥å‘Š", "type": "main", "index": 0 }]] }
  },

  "settings": {
    "executionOrder": "v1"
  }
}
