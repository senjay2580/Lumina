# 开发工作流

## 开始开发前

### 1. 确保上下文清晰

```
读取 /memory-bank 中的所有文档，implementation-plan.md 是否清晰？
你有什么问题需要我澄清的？
```

AI 通常会问 9-10 个问题，回答后让它更新 implementation-plan.md。

### 2. 第一个实施提示词

```
读取 /memory-bank 中的所有文档，执行实施计划的 Step 1。

规则：
1. 我会运行测试
2. 测试通过前不要开始 Step 2
3. 完成后更新 progress.md
4. 添加架构说明到 architecture.md
```

### 3. 使用正确的模式

- **Ask/Plan 模式**：先让 AI 解释它要做什么
- **确认后**：再让 AI 执行

---

## 迭代开发流程

### 标准工作流

```
┌─────────────────────────────────────────────────────┐
│  1. 读取 memory-bank                                 │
│     ↓                                               │
│  2. 执行当前 Step                                    │
│     ↓                                               │
│  3. 运行测试                                         │
│     ↓                                               │
│  4. 测试通过 → 提交 Git → 更新 progress.md           │
│     ↓                                               │
│  5. 开新会话 → 回到步骤 1                            │
└─────────────────────────────────────────────────────┘
```

### 每个 Step 完成后

1. **提交 Git**
   ```bash
   git add .
   git commit -m "Step X: 简短描述"
   ```

2. **开新会话**
   ```
   /new 或 /clear
   ```

3. **继续下一步**
   ```
   读取 /memory-bank 中的所有文档，查看 progress.md 了解已完成的工作，
   然后执行 Step X。测试通过前不要开始下一步。
   ```

---

## 添加新功能

基础游戏/应用完成后，开始添加细节功能。

### 1. 为每个功能创建实施文档

```markdown
# feature-fog-effect.md

## 功能描述
添加雾效果，增加游戏氛围

## 实施步骤

### Step 1: 添加雾着色器
- 创建 fog.glsl 文件
- 定义雾的颜色和密度参数
- **测试**：场景中出现淡淡的雾

### Step 2: 添加动态效果
- 雾随时间变化
- 根据玩家位置调整
- **测试**：雾有动态变化效果
```

### 2. 使用具体的提示词

❌ 错误示例：
```
给我做一个漂亮的飞机
```

✅ 正确示例：
```
在机翼上切出副翼的空间，副翼宽度为机翼的 20%，
位于机翼外侧 1/3 处
```

---

## 调试技巧

### 遇到错误时

#### JavaScript 错误

1. 打开控制台 (F12)
2. 复制错误信息
3. 提供给 AI：

```
## 错误信息
TypeError: Cannot read property 'map' of undefined
at UserList.js:15

## 相关代码
[粘贴相关代码片段]

## 我尝试过
- 检查数据是否为空
- 添加条件渲染
```

#### 视觉问题

截图并描述：
```
## 问题
按钮位置不对，应该在右下角，但显示在左上角

## 截图
[附上截图]

## 期望效果
按钮固定在页面右下角，距离边缘 20px
```

### 卡住时的解决方案

#### 方案 1：回滚重试

```bash
git reset --hard HEAD~1  # 回滚到上一个提交
```

然后用新的提示词重试。

#### 方案 2：获取全局视角

使用工具（如 RepoPrompt）将整个代码库导出为一个文件，
然后问 AI：

```
这是我的完整代码库，我遇到了 [问题描述]，
请分析可能的原因并给出解决方案。
```

#### 方案 3：开新窗口

有时候上下文污染了，开一个全新的会话重新开始。

---

## Claude Code / Codex CLI 技巧

### 常用命令

| 命令 | 作用 |
|------|------|
| `/init` | 初始化项目规则 |
| `/new` | 开新会话 |
| `/clear` | 清除上下文 |
| `/compact` | 压缩上下文但保留关键信息 |
| `/rewind` | 回滚到之前的状态 |

### 自定义命令

创建快捷命令，如 `/explain`：

```
/explain $arguments

触发提示词：
"深入分析代码，理解 $arguments 是如何工作的。
理解后告诉我，然后我会给你具体任务。"
```

### 危险模式（谨慎使用）

```bash
# Claude Code
claude --dangerously-skip-permissions

# Codex CLI
codex --yolo
```

跳过所有确认，AI 会自动执行所有操作。
